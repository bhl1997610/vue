// const BoxApp = require('../src/boxApp.js');
// const BoxSystem = require('../src/boxSystem.js');
var path = require('path');
var index = require('./routers/index');
var ejs = require('ejs');
var cookieParser = require('cookie-parser');

var express = require('express');
var session = require('express-session');

var app = express();
app.use(cookieParser());

app.use(session({
    secret: '12345',
    cookie:{maxAge:24*60*60*1000},
}));
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'ejs');

// app.engine('html', ejs.__express);
// app.set('view engine', 'ejs')
app.use(function(req, res, next) {
    res.setHeader('Cache-Control', 'no-cache, no-store, must-revalidate');
    res.setHeader('Pragma', 'no-cache');
    res.setHeader('Expires', '0');
    next();
  });
app.use('/', index);
// console.log(loginJs, 889);

module.exports = app;

// let myBoxApp = new BoxApp('http://test.box.imeete.com', 98, '492b63b13989b701c5a08c9fc61192c3');
// let myBoxSystem = new BoxSystem('http://test.box.imeete.com', 'admin', '58efa280905750c02e14ace011a547fb');

// let temp_ticket = null, app_token;
// myBoxApp.login('wutai@bianfeng.com', '111111').then(async data => {
//     temp_ticket = data.data.temp_ticket;
//     console.log(data,'登陆');
//     // 验证登陆
//     await myBoxApp.auth_verify(temp_ticket).then(data => {
//         console.log(data, '验证登陆');
//         app_token = data.data.app_token;
//     })
//     // myBoxApp.auth_type('wutai@bianfeng.com').then(data => {
//     //     console.log(data, '获取登陆类型');
//     // })

//     // myBoxApp.auth_sms('wutai@bianfeng.com').then(data => {
//     //     console.log(data, '发送短信');
//     // })

//     // myBoxApp.user_info(temp_ticket, 'info').then(data => {
//     //     console.log(data, '获取用户信息');
//     // })
//     // myBoxApp.get_scope_list().then(data => {
//     //     console.log(data, '应用作用域');
//     // })
//     myBoxApp.get_scope_managers().then(data => {
//         console.log(data, '获取作用域管理员')
//     })
// });

// myBoxSystem.search_user('wutai', 1).then(data => {
//     console.log(JSON.stringify(data), '用户搜索');
// });

// myBoxSystem.dept_list().then(data => {
//     console.log(JSON.stringify(data), '获取部门列表');
// });
